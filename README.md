 <img src="https://img.shields.io/badge/-Python-F2C63C.svg?logo=python&style=for-the-badge">

<img width="947" alt="スクリーンショット 2024-08-05 22 52 21" src="https://github.com/user-attachments/assets/076a7d30-bf82-42ae-8369-e095a6fda8a2">

## 概要
このリポジトリは、天文学および惑星科学における透過スペクトルの解析を行うためのPythonコード、IRD_654_221221_check&simplify_filenumchanged copy.ipynb
を含んでいます。このコードは、惑星大気の観測データを用いて、大気の組成や特性を推定するためのツールです。

## 目的
このコードの目的は、観測データから透過スペクトルを生成し、そのスペクトルに基づいて惑星大気の特徴を明らかにするプロトコルを提供することです。このコードは、惑星大気の透過光分光観測データを解析するために開発しました。
コード背景説明.pdf では、研究の背景から、解析のプロセスを簡単に説明しています。

## 使い方
1. リポジトリをクローンするか、ダウンロードします。
2. `Jupyter Notebook` 形式で提供される `.ipynb` ファイルを開きます。
3. 必要なライブラリをインストールし、データセットを準備します。こちらのデータセットは公開できないので、オープンソースの大気スペクトルデータを探してくるのをおすすめします。
4. 各セルを順に実行し、データの読み込みから解析までのプロセスを実行します。読み込むターゲット（惑星）によって計算式が変わるため、計算式を理解した上で使用することをおすすめします。

```bash
git clone https://github.com/ZWITSCHERNDECAT/Transmission-spectra-protocol.git
```

## 使用言語・フレームワーク
- **Python 3.10**
- **Jupyter Notebook**
- **主要ライブラリ**
  - NumPy 1.24.0
  - Matplotlib 3.7.0
  - Pandas 1.5.3
  - SciPy 1.10.0
  - Astropy 5.2

## こだわりのポイント
本コードは、スペクトル解析の厳密性、計算の正確さを重視していおり、こだわったポイントは以下になります。
- **データの前処理**: 透過スペクトル解析において、観測データのクリーンアップと前処理が非常に重要です。このコードでは、データノイズの除去や異常値の検出と修正を効率的に行うための機能を実装しています。
- **誤差伝播を厳密に考えた**: スペクトル解析の全過程に置いて、必要な誤差伝播の計算を取り入れています。
- **カスタマイズ可能な解析プロセス**: 研究目的に応じて、解析プロセスをカスタマイズできるように設計しました。ユーザーは簡単にパラメータを調整し、独自の解析を行うことができます。
- **視覚化**: 惑星のトランジット分光は、時系列の確認が大事なので、解析結果を直感的に理解できるように、Matplotlibを用いた時系列ごとのグラフを見やすいように並べました。視覚的な結果から、トランジットイン、アウトの際のスペクトルの変化や、誤差の確認に役立ちます。また、基本的にスペクトルの各データに誤差範囲を表記しています。さらに、見るべき波長帯を特定できるように波長間隔、フラックスの範囲を工夫しました。
- **データ間隔が異なるスペクトルを足し合わせるアルゴリズム**: 撮ったスペクトルの一部は、データが等間隔ではない部分があるので、そのような数多くあるスペクトルを足し合わせるアルゴリズムを作りました。

## 研究の要旨
ケプラーおよびTESS宇宙望遠鏡の打ち上げ以降、小型惑星、すなわちサブネプチューン（地球半径の2〜4倍）およびスーパーアース（地球半径の1〜1.5倍）の数が増え、これらが系外惑星の大多数を占めるようになりました。半径の谷（地球半径の1.5〜2倍）は、これらの惑星が原始的なH/He大気を維持できるかどうかの境界と考えられています。しかし、実際の境界は大気の検出によって直接確認されたことはなく、小型惑星の多様な組成を形成するメカニズムは不明です。

ヘリウム三重項は、小型惑星の原始大気を検出するための効果的な吸収線です。恒星からのX線および極紫外線放射によって、惑星のH/He大気が数倍の惑星半径まで膨張し、さらに星間吸収の影響を受けないため、地上から観測可能です。K型矮星やM型矮星は、ヘリウム三重項の形成に理想的なスペクトル型と考えられています。

本研究では、すばる望遠鏡/IRDを用いた高分解能（約70,000）透過分光法を実施しました。半径の谷の上限に位置するM型矮星周囲の短周期サブネプチューン候補TOI 654.01のトランジットを観測しました。観測データから太陽視線速度、恒星の固有運動、惑星の視線速度の影響、および地球大気による汚染を補正し、惑星スペクトルから恒星スペクトルを除去しました。

その結果、ヘリウム三重項の過剰吸収率に対して90%の信頼度で3.3%の上限を設定しました。この結果から、ヘリウム大気の存在を否定することはできません（つまり、この惑星が原始大気によって形成されたか、またはそのヘリウム大気が大気散逸から生き残ったかどうかは不明です）。しかし、仮にヘリウム三重項が存在していたとしても、弱い恒星の極紫外線放射が原因でヘリウム三重項が観測されなかった可能性があると考えられます。

